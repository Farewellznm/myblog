---
title: "10xCellranger自定义参考基因组"
author: "LHS"
date: "2021-09-03"
category: bioinfo
tags: 
- 组学分析
output: html_document
draft: False
---

GTF文件包含无 polyA 的转录本的条目，这些条目会和编码蛋白的基因重叠。由于注释的重叠，这些条目会导致reads被标记为映射到多个基因（多映射）。在reads被标记为多映射的情况下，它们不会被再计数（cellranger官方解释了这种计数规则[^1]）。

```
cellranger mkgtf Danio_rerio.GRCz11.99.chr.gtf\
Danio_rerio.GRCz11.99.chr.filtered.gtf\
--attribute=gene_biotype:protein_coding
```
# 定制化参考基因组

有些异源转基因研究产生的特定样本，需要定制化marker基因。这时候需要将其加入GTF和FASTA文件中。GFP蛋白是一种绿色荧光标记，

我的GFP序列为GFP.fa,不同研究的会有差异：
```
>GFP
ATGGTGAGCAAGGGCGAGGAGCTGTTCACCGGGGTGGTGCCCATCCTGGTCGAGCTGGACGGCGACGTAAACGGCCACAAGTTCAGCGTGTCCGGCGAGGGCGAGGGCGATGCCACCTACGGCAAGCTGACCCTGAAGTTCATCTGCACCACCGGCAAGCTGCCCGTGCCCTGGCCCACCCTCGTGACCACCCTGACCTACGGCGTGCAGTGCTTCAGCCGCTACCCCGACCACATGAAGCAGCACGACTTCTTCAAGTCCGCCATGCCCGAAGGCTACGTCCAGGAGCGCACCATCTTCTTCAAGGACGACGGCAACTACAAGACCCGCGCCGAGGTGAAGTTCGAGGGCGACACCCTGGTGAACCGCATCGAGCTGAAGGGCATCGACTTCAAGGAGGACGGCAACATCCTGGGGCACAAGCTGGAGTACAACTACAACAGCCACAACGTCTATATCATGGCCGACAAGCAGAAGAACGGCATCAAGGTGAACTTCAAGATCCGCCACAACATCGAGGACGGCAGCGTGCAGCTCGCCGACCACTACCAGCAGAACACCCCCATCGGCGACGGCCCCGTGCTGCTGCCCGACAACCACTACCTGAGCACCCAGTCCAAGCTGAGCAAAGACCCCAACGAGAAGCGCGATCACATGGTCCTGCTGGAGTTCGTGACCGCCGCCGGGATCACTCTCGGCATGGACGAGCTGTACAAGTAAAGCGGCCGCGACTCTAGTCTCGAGCTGCAGGCATGCAAGCTTCTTAGACATGACTGTTCCTCAGTTCAAGTTGGGCACTTACGAGAAGACCGGTCTTGCTAGATTCTAATCAAGAGGATGTCAGAATGCCATTTGCCTGAGAGATGCAGGCTTCATTTTTGATACTTTTTTATTTGTAACCTATATAGTATAGGATTTTTTTTGTCATTTTGTTTCTTCTCGTACGAGCTTGCTCCTGATCAGCCTATCTCGCAGCTGATGAATATCTTGTGGTAGGGGTTTGGGAAAATCATTCGAGTTTGATGTTTTTCTTGGTATTTCCCACACATGTGAGCAAAAGGCCAGCAAAAGGCCAGGAACCGTAAAAAGGCCGCGTTGCTGGCGTT

```


统计GFP基因的碱基个数，

```
cat GFP.fa | grep -v "^>" | tr -d "\n" | wc -c
```
创建GFP GTF 文件
```
echo -e 'GFP\tunknown\texon\t1\t717\t.\t+\t.\tgene_id "GFP"; transcript_id "GFP"; gene_name "GFP"; gene_biotype "protein_coding";' > GFP.gtf
```

# Reference  
[^1]:[cellranger count](https://kb.10xgenomics.com/hc/en-us/articles/115003710383-Which-reads-are-considered-for-UMI-counting-by-Cell-Ranger-)