---
title: "假设检验与P是如何矫正的？"
author: "LHS"
date: "2021-03-27"
category: Bioinfo
tags: 
- Bioinfo
output: html_document
---

# 假设检验

>假设检验的基本思想是小概率反证法思想。小概率事件是指小概率事件（P<0.01|0.05)在一次实验中基本不会发生。反证法的思想是先提出假设（检验假设$H_0$),再用适当的方法确认假设成立的可能性大小，如果可能性小，则认为假设不成立；若可能性大，则没有充分的证据说明假设不成立。

假设检验的步骤主要有 1）提出原假设，根据以往经验提出的默认假设 2）显著性水平的确定 3）证据收集，计算检验统计量 4）检验。假设检验最后结果如下表所示：

![](https://user-images.githubusercontent.com/38640955/117126549-77846b80-adcd-11eb-9b30-15425b32bc18.png)

金标准代表客观正确的事实；决策代表检验者得出的结论。

如表所示：**假阳性，第一类错误α，拒绝了实际上成立的H0，为“弃真”错误；假阴性，第二类错误β，接受了实际上不成立的H0，为“纳伪”错误。**

# 假阳性和假阴性

假阴性和假阳性是针对于`筛查方法`产生的结果来说的。假设检验中，原假设H0一般为阴性结果，备择假设一般为阳性结果。 


`假阳性`意思为，看起来显著但是实际上是阴性的结果，在实验中如果选择了假阳性的结果会导致后面的实验失败。

`假阴性`意思为，看起来是不显著但是实际上是阳性的结果，在实验中如果假阴性检出率过大，会影响新的独特的实验结果，以及对表达差异不大的基因会漏样，进而掩盖那些真正有差异的基因。

实际上，$\alpha$和$\beta$之间是互斥的，我能可以直观的从标准想像出：当$\alpha$显著水平趋于零时，则决策中完全的消除了阳性结果，决策为H0，此时存在很多假阴性结果（$\beta$）；反而$\beta$趋于零时，做出的结果为HA，则其中存在很多假阳性结果（$\alpha$）。在生物学实验中，对假阳性的容忍程度一般低于假阴性，即尽量保守的减少阴性的结果的产生而不在意新的结果的检出，这是一种保守的做法。

# 检验的势

当得出P>0.05时，一方面认为没有证据拒绝H0；另一方面也应该注意是否由于样本数量小，检验功效不够大导致的不能检出阳性结果HA。

`检验的势`(power of the test)定义为在原假设是错误的情况下正确拒绝原假设的概率。检验的势等于1减去犯第二类错误的概率：1-β；**当两个总体参数的确存在差异时，所使用的统计检验能够发现这种差异的概率。** 1-β最好大于80%。

可通过如下公式计算β：

$$
Z_\beta = \frac{\sqrt{n}\delta}{\sigma}-Z_\alpha
$$
其中 n为样本量；$\delta$偏差；$\sigma$总体标准差；$Z_\alpha$:标准正态分布临界值，单侧检验取单侧，双侧取双侧;$Z_\beta$:标准正态分布上侧尾部$\beta$临界值。

通过计算$Z_\beta$反查正态分布获得$\beta$，进而获得检验的势[^2]。


# P值的矫正方法



多重假设检验中，尽管假阳性阈值控制为p = 0.05已经很低了，但是由于次数很多，其总的检出数目也会很大（5%*20000=1000）。



# FDR计算

# R中矫正P值获得q值



Ref:

[^2]:[检验的势](https://blog.csdn.net/huangguohui_123/article/details/103781521)





